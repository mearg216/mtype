<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset-"UTF-8">
    <meta name="viewport" content="width=device-width, initial -scale=1.e">
    <title>Mtype</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <style>
      body{
        font-family: monospace;
        color: white;
        background-color: black;
      }
      .heading{
        margin: 10px;
      }
      .mtype{
        color: dodgerblue;
      }
      .container{
        margin: 50px;
        display: flex;
        flex-direction: column;
        align-items: center;
      }
      .timer{
        align-self: flex-start;
        color: orange;
        font-size: 16px;
        margin-bottom: 0;
      }
      .main-printer{
        font-size: 20px;
        background-color: rgba(32, 32, 32, 1);
	    display: inline-block;
      }
      .printer{
        font-family: monospace;
	    background-color: rgba(50, 50, 50, 1);
      }
      .back-text{
        font-family: monospace;
        color:gray;
      }
      .mistake{
        color: red;
      }
      .sp-mistake{
        background-color: rgba(255, 0, 0, 0.3);
      }
      .retry-btn{
        background-color: black;
        border: 1px solid dodgerblue;
	    padding: 5px;
        padding-left: 15px;
        padding-right: 15px;
        border-radius: 5px;
	    display: flex;
	    justify-content: center;
	    align-items: center;
      }
      .retry-btn:hover{
        box-shadow: 0 0 10px 2px rgba(47, 137, 255, 0.4);
      }
      .retry-btn:active{
        box-shadow: 0 0 10px 0px rgba(47, 137, 255, 0.4);
      }
    </style>
  </head>
  <body>
    <h1 class="heading">welcome to <span class="mtype">áˆ›Type</span></h1>
    <div class="container">
      <p class="timer">00:00</p>
      <p class="main-printer"><span class="printer"></span><span class="back-text"></span></p>
      <button class="retry-btn"><i class="fa fa-refresh" style="color: white;"></i></button>
    </div>
    
    
    <script> 
      const messages = [
        "My code compiled on the first try. I immediately checked for a carbon monoxide leak. This success felt deeply unnatural and suspicious.",
        "Why do programmers prefer dark mode? Because the light attracts bugs! We also hate glare while debugging our self-esteem.",
        "I asked my rubber duck for help. It just floated there, silently judging my life choices. The debugging session was unproductive.",
        "There are only two hard problems in computer science. Naming things, cache invalidation, and off-by-one errors. I just proved my point.",
        "My function works perfectly, but I don't know why. Deleting it to start over would be professional suicide. I live in fear.",
        "It works on my machine is the programmer's equivalent of a wizard did it. Both explanations end the conversation immediately.",
        "I spent three hours optimizing a script that runs once a year. I have saved ten milliseconds of total compute time. Victory!",
        "Google is my senior developer. Stack Overflow is my tech lead. Together, we form a competent and well-paid engineering team.",
        "The meeting could have been an email. The email could have been a text. The text was just a crying emoji.",
        "I finally understood recursion. I finally understood recursion. This joke only works if you finally understood recursion. Did you get it?"
      ];
      
      const realTexa = messages[Math.round(Math.random() * 9)];
      const body = document.querySelector('body');
      const heading = document.querySelector('.heading');
      
      const mainPrinter = document.querySelector('.main-printer');
      const printer = document.querySelector('.printer');
      
      let arr = realTexa.split("");
      let index = 0;
      let addedTexa = "";
      let addedTexArr = [];
      let backArr = realTexa.split("");
      let backbench = [];
      
      document.querySelector('.back-text').innerHTML = realTexa;
      
      body.addEventListener('keydown', event => {
        if(event.key != 'Control' && event.key != 'Shift' && event.key != 'Backspace' && arr[index]){
          if(event.key !== arr[index]){
            if(arr[index] == " "){
              addedTexa = `<span class="sp-mistake">${arr[index]}</span>`;
              printer.innerHTML += addedTexa;
            } 
            else{
              addedTexa = `<span class="mistake">${arr[index]}</span>`;
              printer.innerHTML += addedTexa;
            }
          } 
          else{
            printer.innerHTML += event.key;
            addedTexa = event.key;
          }
          index++;
          addedTexArr.push(addedTexa.length);
          
          backbench.push(backArr[0]);
          backArr.splice(0, 1);
          let backText = backArr.join("");
          mainPrinter.innerHTML = `<span class="printer">${printer.innerHTML}</span><span class="back-text">${backText}</span>`;
        }
        
        if(event.key == 'Backspace' && arr[index-1]){
          let addedTexlen = addedTexArr[addedTexArr.length-1];
          printer.innerHTML = printer.innerHTML.slice(0, printer.innerHTML.length-addedTexlen);
          index--;
          addedTexArr.pop();
          
          
          let backElem = backbench.length-1;
          backArr.unshift(backbench[backElem]);
          console.log(backbench[backElem]);
          backbench.pop();
          let backText = backArr.join("");
          mainPrinter.innerHTML = `<span class="printer">${printer.innerHTML}</span><span class="back-text">${backText}</span>`;
        }
        console.log(event.key);
      });
      
      
    </script>
  </body>
</html>